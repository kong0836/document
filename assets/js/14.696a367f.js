(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{390:function(a,t,s){"use strict";s.r(t);var e=s(44),v=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"at"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#at"}},[a._v("#")]),a._v(" at")]),a._v(" "),s("p",[a._v("使用 "),s("code",[a._v("at")]),a._v(" 命令，你可以在特定时间自动完成你所设定的任务，也可以实现自动化，非常方便快捷！")]),a._v(" "),s("h3",{attrs:{id:"安装-at-命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装-at-命令"}},[a._v("#")]),a._v(" 安装 at 命令")]),a._v(" "),s("p",[a._v("一般来讲，大部分 Linux 发行版都已经安装了 "),s("code",[a._v("at")]),a._v(" 命令，不确定的话可以使用 "),s("code",[a._v("at -V")]),a._v(" 命令查看，如果有版本返回，说明就可以正常使用 "),s("code",[a._v("at")]),a._v(" 命令。")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ at -V\nat version "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3.1")]),a._v(".13\n")])])]),s("p",[a._v("你可能还需要启动 at 守护进程，称为 "),s("code",[a._v("atd")]),a._v(" 。在大多数 Linux 系统上，你可以使用 "),s("code",[a._v("systemctl")]),a._v(" 命令启用 "),s("code",[a._v("atd")]),a._v(" 服务并将它们设置为从现在开始自动启动：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" systemctl "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("enable")]),a._v(" --now atd\n")])])]),s("h3",{attrs:{id:"at-命令基本用法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#at-命令基本用法"}},[a._v("#")]),a._v(" at 命令基本用法")]),a._v(" "),s("ul",[s("li",[s("strong",[a._v("语法")])])]),a._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("at")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("[选项] [日期时间]")]),a._v("\n")])])]),s("ul",[s("li",[s("strong",[a._v("选项")])])]),a._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[a._v("-f：指定包含具体指令的任务文件\n-q：指定新任务的队列名称\n-l：显示待执行任务的列表\n-d：删除指定的待执行任务\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("-m：任务执行完成后向用户发送")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("E-mail")]),a._v("\n")])])]),s("ul",[s("li",[s("strong",[a._v("参数")])])]),a._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[a._v("日期时间：指定任务执行的日期时间\n")])])]),s("h3",{attrs:{id:"使用-at-命令交互性安排任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-at-命令交互性安排任务"}},[a._v("#")]),a._v(" 使用 at 命令交互性安排任务")]),a._v(" "),s("p",[a._v("想想看，我们平时是怎么使用闹钟这个工具的？首先我们点击闹钟软件上的加号，然后再设定时间，再在备注里输入闹钟的目的。")]),a._v(" "),s("p",[a._v("使用 at 命令交互性安排任务也是一样的道理。首先你输入 "),s("code",[a._v("at")]),a._v(" 命令，然后再跟上具体的时间。")]),a._v(" "),s("p",[a._v("回车之后就进入到交互性界面，你再具体输入要做的事情（命令），最后以结束输入，任务就设置好了。")]),a._v(" "),s("p",[a._v("例如，你想在早上 11:20 的时候，在 "),s("code",[a._v("at-test.txt")]),a._v(" 文档里写入 "),s("code",[a._v("hello world")]),a._v(" 这句话，可以这样交互性输入：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ at "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("11")]),a._v(":20 AM\nwarning: commands will be executed using /bin/sh\nat"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"hello world"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" ~/at-test.txt\nat"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("EOT"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\njob "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(" at Mon Jul "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("26")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("11")]),a._v(":20:00 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2021")]),a._v("\n")])])]),s("p",[a._v("如上所示，"),s("code",[a._v("at")]),a._v(" 命令使用直观和自然的时间格式。你不需要知道 24 小时制或将时间转换为 UTC 格式。通常，可以直接使用我们生活中常用的单词它就能理解，例如"),s("em",[a._v("noon")]),a._v("、 "),s("em",[a._v("1:30 PM")]),a._v("、 "),s("em",[a._v("13:37")]),a._v("等。")]),a._v(" "),s("p",[a._v("在 11:20 过后，你可以使用 "),s("code",[a._v("cat")]),a._v(" 命令检查一下 "),s("code",[a._v("at-test.txt")]),a._v(" 文件是否有内容写入：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" ~/at-test.txt\nhello world\n")])])]),s("h3",{attrs:{id:"使用-at-命令安排任务"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用-at-命令安排任务"}},[a._v("#")]),a._v(" 使用 at 命令安排任务")]),a._v(" "),s("p",[a._v("如果你不想使用交互的方式来给 "),s("code",[a._v("at")]),a._v(" 命令安排任务，可以使用管道将 "),s("code",[a._v("echo")]),a._v(" 或 "),s("code",[a._v("printf")]),a._v(" 的值传递给 "),s("code",[a._v("at")]),a._v(" 命令。")]),a._v(" "),s("p",[a._v("比如，我想从现在开始一分钟后向 "),s("code",[a._v("at-test.txt")]),a._v(" 文件写入 "),s("code",[a._v("hello again")]),a._v(" 语句：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"echo 'hello again' >> ~/at-test.txt\"")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" at now +1 minute\n")])])]),s("p",[a._v("一分钟后，验证新命令是否已执行：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" ~/at-test.txt\nhello world\nhello again\n")])])]),s("h3",{attrs:{id:"时间表达式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#时间表达式"}},[a._v("#")]),a._v(" 时间表达式")]),a._v(" "),s("p",[a._v("前面提到过，"),s("code",[a._v("at")]),a._v(" 命令使用的是我们日常生活中所使用的时间格式，非常方便：")]),a._v(" "),s("ul",[s("li",[a._v("YYMMDDhhmm[.ss] （缩写年、月、日、小时、分钟[秒]）")]),a._v(" "),s("li",[a._v("CCYYMMDDhhmm[.ss] （完整年、月、日、小时、分钟和[秒]）")]),a._v(" "),s("li",[a._v("now")]),a._v(" "),s("li",[a._v("midnight")]),a._v(" "),s("li",[a._v("noon")]),a._v(" "),s("li",[a._v("teatime`（下午4点）")]),a._v(" "),s("li",[a._v("AM")]),a._v(" "),s("li",[a._v("PM")])]),a._v(" "),s("p",[a._v("时间和日期可以是绝对的，也可以添加一个加号 ( "),s("em",[a._v("+")]),a._v(" ) 使它们相对于"),s("em",[a._v("现在")]),a._v("。在指定相对时间时，下面这些日常生活中所使用的词汇都可以使用：")]),a._v(" "),s("ul",[s("li",[a._v("minutes")]),a._v(" "),s("li",[a._v("hours")]),a._v(" "),s("li",[a._v("days")]),a._v(" "),s("li",[a._v("weeks")]),a._v(" "),s("li",[a._v("months")]),a._v(" "),s("li",[a._v("years")])]),a._v(" "),s("p",[a._v("下面是一些 "),s("code",[a._v("at")]),a._v(" 命令有效表达式的示例：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"rsync -av /home/tux me@myserver:/home/tux/"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" at "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(":30 AM tomorrow\n$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/opt/batch.sh ~/Pictures"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" at "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(":30 AM 08/01/2022\n$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"echo hello"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" at now + "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(" days\n")])])]),s("h3",{attrs:{id:"查看-at-任务队列"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看-at-任务队列"}},[a._v("#")]),a._v(" 查看 at 任务队列")]),a._v(" "),s("p",[a._v("随时时间的推移，我们可以忘记在 "),s("code",[a._v("at")]),a._v(" 命令队列时设置了多少个任务，如果你想进行查看，可以使用 "),s("code",[a._v("atq")]),a._v(" 命令：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ atq\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(" Thu Jul "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("29")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("12")]),a._v(":19:00 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2021")]),a._v(" a tux\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9")]),a._v("  Tue Jul "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("27")]),a._v(" 03:30:00 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2021")]),a._v(" a tux\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),a._v("  Tue Jul "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("27")]),a._v(" 00:00:00 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2021")]),a._v(" a tux\n")])])]),s("p",[a._v("要从队列中删除任务，请使用 "),s("code",[a._v("atrm")]),a._v(" 命令和任务编号。例如要删除任务 7 ：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("$ atrm "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),a._v("\n$ atq\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(" Thu Jul "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("29")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("12")]),a._v(":19:00 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2021")]),a._v(" a tux\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9")]),a._v("  Tue Jul "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("27")]),a._v(" 03:30:00 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2021")]),a._v(" a tux\n")])])]),s("p",[a._v("如果想要查看计划任务中的具体内容，就必须查看 "),s("code",[a._v("at spool")]),a._v(" 。只有 root 用户才能查看"),s("code",[a._v("at")]),a._v(" spool，因此你必须使用 "),s("code",[a._v("sudo")]),a._v(" 来查看 "),s("code",[a._v("spool")]),a._v(" 或 "),s("code",[a._v("cat")]),a._v(" 任务的内容。")]),a._v(" "),s("h3",{attrs:{id:"小结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[a._v("#")]),a._v(" 小结")]),a._v(" "),s("p",[s("code",[a._v("at")]),a._v(" 命令是避免忘记在将来特定时间的任务或在你离开时让计算机为你运行任务的非常好的方式。与 "),s("code",[a._v("cron")]),a._v(" 命令不一样的是，它不需要使任务从现在一直循环运行，因此它的语法比 "),s("code",[a._v("cron")]),a._v(" 简单得多。")]),a._v(" "),s("h3",{attrs:{id:"原文链接"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#原文链接"}},[a._v("#")]),a._v(" 原文链接")])])}),[],!1,null,null,null);t.default=v.exports}}]);